<h2 mat-dialog-title>Apply to Job</h2>

<mat-dialog-content>
  <!-- Error message -->
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <!-- Success message -->
  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>

  <form [formGroup]="applyForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="resume">Resume (PDF or DOC)</label>
      <input 
        type="file" 
        id="resume" 
        formControlName="resume"
        (change)="onFileSelected($event)" 
        accept=".pdf,.doc,.docx" 
        [class.is-invalid]="f['resume'].touched && f['resume'].invalid"
      >
      <div *ngIf="f['resume'].touched && f['resume'].invalid" class="invalid-feedback">
        Resume is required
      </div>
    </div>
    
    <div class="form-group">
      <label for="coverLetter">Cover Letter (Optional)</label>
      <textarea 
        id="coverLetter" 
        formControlName="coverLetter"
        rows="5"
        placeholder="Write your cover letter here..."
      ></textarea>
    </div>
    
    <button 
      type="submit" 
      [disabled]="isApplying || applyForm.invalid"
      mat-raised-button 
      color="primary"
    >
      <span *ngIf="!isApplying">Submit Application</span>
      <span *ngIf="isApplying">
        <mat-icon class="spinner">hourglass_empty</mat-icon>
        Applying...
      </span>
    </button>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button mat-raised-button color="primary" (click)="onSubmit()" 
          [disabled]="!applyForm.valid || isApplying">
    Submit Application
  </button>
</mat-dialog-actions>
